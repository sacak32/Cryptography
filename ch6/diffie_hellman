p = 2671
R = Integers(p)
A = 171
B = 853
E = EllipticCurve( GF(p), [0,0,0,A,B] )
P = E(1980,431)
Qa = E(2110,543)
nb = 1943

# Part a
Qb = nb*P
print( "Qb:", Qb )

# Part b
S = nb*Qa
print( "S:", S )

# Part c
for i in range( 2 * p ):
	if i*P == Qa:
		print ( i, "P:", i*P )
		break 

# Part d		
xa = R(2)
nb = 875

Qb = nb*P
print ( "Qb:", Qb )

nb = R(875)
ya2 = xa^3 + A*xa + B
ya = ya2.sqrt(all=True)
print ( "for xa:", xa, "ya^2:", ya2, "ya:", ya )

Qa = E(2,2575)
nb = 875
S = nb*Qa
print ( "S:", S )
